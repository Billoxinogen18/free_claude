/* src/index.css - BASELINE RESTORED & TO BE INCREMENTALLY MODIFIED */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

:root {
  --font-family: 'Poppins', sans-serif;
  --transition-speed-fast: 0.2s;
  --transition-speed-medium: 0.4s;
  --transition-speed-slow: 0.6s;
  --border-radius-main: 24px; 
  --border-radius-medium: 18px;
  --border-radius-small: 14px;

  /* Light Mode Variables (Matches the screenshots you liked) */
  --lm-bg-gradient: linear-gradient(135deg, #e6e7ee, #d1d9e6);
  --lm-text-primary: #3a3a3a; /* From earlier good version */
  --lm-text-secondary: #5b5b5b; /* From earlier good version */
  --lm-primary-accent: #6d5dfc; /* From earlier good version */
  --lm-secondary-accent: #8981f7; /* From earlier good version */
  --lm-error-accent: #ff708b;

  --lm-neumorphic-shadow-light: rgba(255, 255, 255, 0.8);
  --lm-neumorphic-shadow-dark: rgba(163, 177, 198, 0.7);
  --lm-neumorphic-distance: 6px; 
  --lm-neumorphic-blur: 15px; 

  /* Glass Variables - Light Mode (to be refined) */
  --lm-header-glass-bg-bottom: rgba(240, 240, 250, 0.35); /* More transparent at bottom */
  --lm-header-glass-bg-top: rgba(230, 235, 245, 0.75);   /* Less transparent at top */
  --lm-chat-area-glass-bg: rgba(240, 245, 250, 0.45);  /* UNIFORM for chat area */
  --lm-input-glass-bg: rgba(240, 240, 250, 0.55);    
  --lm-ai-bubble-glass-bg: rgba(235, 240, 250, 0.7); 

  --lm-glass-border: rgba(255, 255, 255, 0.6);
  --lm-glass-blur-amount: 10px; 
  --lm-header-blur-amount: 8px; /* Header specific for text behind */
  --lm-glass-glow: 0 0 15px rgba(200, 200, 255, 0.3);
  --lm-bg-for-neumorph: #e9eef5;


  /* Dark Mode Variables (Matches the screenshots you liked) */
  --dm-bg-gradient: linear-gradient(135deg, #2c2f3c, #1e2028);
  --dm-text-primary: #e0e0e0;  /* From earlier good version */
  --dm-text-secondary: #b0b0b0; /* From earlier good version */
  --dm-primary-accent: #7f70ff; /* From earlier good version */
  --dm-secondary-accent: #9d92fc; /* From earlier good version */
  --dm-error-accent: #ff8097;

  --dm-neumorphic-shadow-light: rgba(60, 60, 75, 0.7); 
  --dm-neumorphic-shadow-dark: rgba(0, 0, 0, 0.4);
  --dm-neumorphic-distance: 6px;
  --dm-neumorphic-blur: 15px;
  
  /* Glass Variables - Dark Mode (to be refined) */
  --dm-header-glass-bg-bottom: rgba(40, 42, 53, 0.45); 
  --dm-header-glass-bg-top: rgba(50, 53, 75, 0.8);   
  --dm-chat-area-glass-bg: rgba(40, 42, 53, 0.55);  /* UNIFORM for chat area */
  --dm-input-glass-bg: rgba(40, 42, 53, 0.65);    
  --dm-ai-bubble-glass-bg: rgba(45, 48, 70, 0.75);   

  --dm-glass-border: rgba(70, 70, 90, 0.5);
  --dm-glass-blur-amount: 10px;
  --dm-header-blur-amount: 9px;
  --dm-glass-glow: 0 0 20px rgba(100, 90, 220, 0.25);
  --dm-bg-for-neumorph: #252833;
}

/* Apply current theme variables (copied from previous version you liked) */
body {
  background: var(--lm-bg-gradient); /* This will be the full page background */
  color: var(--lm-text-primary);
  --current-text-primary: var(--lm-text-primary);
  --current-text-secondary: var(--lm-text-secondary);
  --current-primary-accent: var(--lm-primary-accent);
  --current-secondary-accent: var(--lm-secondary-accent);
  --current-error-accent: var(--lm-error-accent);
  --current-neumorphic-shadow-light: var(--lm-neumorphic-shadow-light);
  --current-neumorphic-shadow-dark: var(--lm-neumorphic-shadow-dark);
  
  --current-header-glass-bg-bottom: var(--lm-header-glass-bg-bottom);
  --current-header-glass-bg-top: var(--lm-header-glass-bg-top);
  --current-chat-area-glass-bg: var(--lm-chat-area-glass-bg);
  --current-input-glass-bg: var(--lm-input-glass-bg);
  --current-ai-bubble-glass-bg: var(--lm-ai-bubble-glass-bg);

  --current-glass-border: var(--lm-glass-border);
  --current-glass-blur-amount: var(--lm-glass-blur-amount);
  --current-header-blur-amount: var(--lm-header-blur-amount);
  --current-glass-glow: var(--lm-glass-glow);
  --current-bg-for-neumorph: var(--lm-bg-for-neumorph);
}

body.dark-mode {
  background: var(--dm-bg-gradient); /* This will be the full page background */
  color: var(--dm-text-primary);
  --current-text-primary: var(--dm-text-primary);
  --current-text-secondary: var(--dm-text-secondary);
  --current-primary-accent: var(--dm-primary-accent);
  --current-secondary-accent: var(--dm-secondary-accent);
  --current-error-accent: var(--dm-error-accent);
  --current-neumorphic-shadow-light: var(--dm-neumorphic-shadow-light);
  --current-neumorphic-shadow-dark: var(--dm-neumorphic-shadow-dark);

  --current-header-glass-bg-bottom: var(--dm-header-glass-bg-bottom);
  --current-header-glass-bg-top: var(--dm-header-glass-bg-top);
  --current-chat-area-glass-bg: var(--dm-chat-area-glass-bg);
  --current-input-glass-bg: var(--dm-input-glass-bg);
  --current-ai-bubble-glass-bg: var(--dm-ai-bubble-glass-bg);
  
  --current-glass-border: var(--dm-glass-border);
  --current-glass-blur-amount: var(--dm-glass-blur-amount);
  --current-header-blur-amount: var(--dm-header-blur-amount);
  --current-glass-glow: var(--dm-glass-glow);
  --current-bg-for-neumorph: var(--dm-bg-for-neumorph);
}

/* General body and root setup */
body, html {
  margin: 0; padding: 0; width: 100vw; height: 100vh;
  overflow: hidden; font-family: var(--font-family);
  -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
  transition: background var(--transition-speed-medium) ease, color var(--transition-speed-medium) ease;
}

#root {
  width: 100%; height: 100%; display: flex;
  justify-content: center; align-items: center;
  padding: clamp(10px, 2vw, 15px); 
  box-sizing: border-box;
}

.app-container.cool-chat-theme {
  width: 100%; height: 100%;
  max-width: 850px; 
  max-height: 90vh; /* Adjusted max height */
  display: flex; flex-direction: column; overflow: hidden; position: relative;
  /* Main app panel itself is now a glassmorphic container on top of the body gradient */
  background: var(--current-glass-bg); /* Use a general glass for the main app container */
  backdrop-filter: blur(calc(var(--current-glass-blur-amount) + 5px));
  -webkit-backdrop-filter: blur(calc(var(--current-glass-blur-amount) + 5px));
  border: 1px solid var(--current-glass-border);
  border-radius: var(--border-radius-main);
  box-shadow: var(--current-glass-glow), 0 15px 50px rgba(0,0,0,0.2);
  padding: 0; /* Padding handled by internal sections */
  box-sizing: border-box;
}

/* Neumorphic Element Base */
.neumorphic-element {
  background: var(--current-bg-for-neumorph);
  border-radius: var(--border-radius-medium);
  box-shadow: 
    var(--lm-neumorphic-distance) var(--lm-neumorphic-distance) var(--lm-neumorphic-blur) var(--current-neumorphic-shadow-dark),
    calc(-1 * var(--lm-neumorphic-distance)) calc(-1 * var(--lm-neumorphic-distance)) var(--lm-neumorphic-blur) var(--current-neumorphic-shadow-light);
  transition: all var(--transition-speed-fast) cubic-bezier(0.25, 0.46, 0.45, 0.94);
}
.neumorphic-element:hover:not(:disabled) {
   box-shadow: 
    calc(var(--lm-neumorphic-distance) * 1.5) calc(var(--lm-neumorphic-distance) * 1.5) calc(var(--lm-neumorphic-blur) * 1.3) var(--current-neumorphic-shadow-dark),
    calc(-1 * var(--lm-neumorphic-distance) * 1.5) calc(-1 * var(--lm-neumorphic-distance) * 1.5) calc(var(--lm-neumorphic-blur) * 1.3) var(--current-neumorphic-shadow-light),
    0 0 0 2.5px color-mix(in srgb, var(--current-primary-accent) 20%, transparent);
   transform: translateY(-2.5px) scale(1.01);
}
.neumorphic-element:active:not(:disabled) {
  box-shadow: 
    inset var(--lm-neumorphic-distance) var(--lm-neumorphic-distance) var(--lm-neumorphic-blur) var(--current-neumorphic-shadow-dark),
    inset calc(-1 * var(--lm-neumorphic-distance)) calc(-1 * var(--lm-neumorphic-distance)) var(--lm-neumorphic-blur) var(--current-neumorphic-shadow-light);
  transform: translateY(0.5px) scale(0.97);
}

/* Glassmorphic Element Base (can be applied to header, input area, etc.) */
.glassmorphic-element {
  backdrop-filter: blur(var(--current-glass-blur-amount));
  -webkit-backdrop-filter: blur(var(--current-glass-blur-amount));
  border: 1px solid var(--current-glass-border);
  border-radius: var(--border-radius-medium); /* Default radius for floating glass panels */
  box-shadow: var(--current-glass-glow), 0 5px 25px rgba(0, 0, 0, 0.08);
  transition: all var(--transition-speed-medium) ease;
}
.glassmorphic-element:hover {
  box-shadow: var(--current-glass-glow), 0 8px 35px rgba(0,0,0,0.12);
  /* background subtly changes on hover */
  background: color-mix(in srgb, currentColor 5%, transparent) !important; /* Use currentColor if no specific bg set */
}


/* --- HEADER SECTION --- */
.app-header {
  padding: 18px clamp(15px, 3vw, 25px); 
  display: flex; justify-content: space-between; align-items: center;
  position: sticky; top: 0; z-index: 20; /* Higher z-index */
  
  /* Gradient Glass Effect for Header */
  background: linear-gradient(to bottom, var(--current-header-glass-bg-top) 0%, var(--current-header-glass-bg-bottom) 100%);
  backdrop-filter: blur(var(--current-header-blur-amount));
  -webkit-backdrop-filter: blur(var(--current-header-blur-amount));
  border-bottom: 1px solid var(--current-glass-border);
  box-shadow: 0 4px 15px rgba(0,0,0,0.07);
  
  /* Match app-container's top rounding, flat bottom */
  border-top-left-radius: var(--border-radius-main); 
  border-top-right-radius: var(--border-radius-main);
  border-bottom-left-radius: 0; 
  border-bottom-right-radius: 0;
  transition: background var(--transition-speed-medium) ease, border var(--transition-speed-medium) ease, box-shadow var(--transition-speed-medium) ease;
}
.header-title-area h1 { /* ... (same as previous good version) ... */ }
.header-controls-area { display: flex; align-items: center; gap: clamp(12px, 1.5vw, 18px); }

.model-selector-container { /* Is .glassmorphic-element */
  padding: 5px; 
  border-radius: var(--border-radius-small);
  background: var(--current-input-glass-bg); /* Consistent glass with input area */
} 
.neumorphic-select { /* ... (same as previous good version) ... */ }
.model-selector-container::after { /* ... (same as previous good version) ... */ }

.theme-toggle-button, .clear-chat-button { /* Are .neumorphic-element */
  width: 46px; height: 46px; border-radius: 50%; 
  font-size: 1.4rem; 
  /* ... (rest same as previous good version) ... */
}
/* Ensure clear button icon color is right in dark mode */
body.dark-mode .clear-chat-button:not(:disabled) svg { fill: var(--dm-text-secondary); }
body.dark-mode .clear-chat-button:hover:not(:disabled) svg { fill: var(--dm-primary-accent); }


/* --- CHAT AREA SECTION --- */
.chat-area {
  flex-grow: 1;
  overflow-y: auto;
  position: relative; /* For scroll-to-bottom button and for content to be under sticky header/footer */
  z-index: 1; /* Lower than header and footer */

  /* This makes the chat area itself glassmorphic, as requested */
  background: var(--current-chat-area-glass-bg);
  backdrop-filter: blur(var(--current-glass-blur-amount)); /* Uniform blur */
  -webkit-backdrop-filter: blur(var(--current-glass-blur-amount));
  /* Optional: border if you want to define the chat area glass from the main app glass */
  /* border-top: 1px solid var(--current-glass-border); */
  /* border-bottom: 1px solid var(--current-glass-border); */
  border-radius: 0; /* Rectangular scroll well */

  /* Padding for content, top/bottom adjusted by JS for header/footer */
  padding: calc(var(--header-height, 80px) + 15px) clamp(10px, 2vw, 20px) calc(var(--footer-height, 90px) + 15px) clamp(10px, 2vw, 20px);
  margin-top: calc(-1 * var(--header-height, 80px)); /* Pulls content under header */
  margin-bottom: calc(-1 * var(--footer-height, 90px)); /* Pulls content under footer */
  
  scrollbar-width: thin; scrollbar-color: var(--current-secondary-accent) transparent;
  transition: background var(--transition-speed-medium) ease;
}
.chat-area::-webkit-scrollbar { width: 8px; }
.chat-area::-webkit-scrollbar-track { background: transparent; }
.chat-area::-webkit-scrollbar-thumb { background-color: var(--current-secondary-accent); border-radius: 10px; }

.message-list { display: flex; flex-direction: column; gap: 22px; margin-top: auto; }

.message-wrapper { /* ... (same as previous good version for animations) ... */ }
.user-message { /* ... (same as previous good version, using claymorphic) ... */ }
.ai-message { 
  background: var(--current-ai-bubble-glass-bg); /* Specific glass for AI bubbles */
  backdrop-filter: blur(var(--current-glass-blur-amount));
  -webkit-backdrop-filter: blur(var(--current-glass-blur-amount));
  border: 1.5px solid var(--current-glass-border);
  color: var(--current-text-primary);
  border-top-left-radius: var(--border-radius-small);
  border-bottom-left-radius: var(--border-radius-main);
  border-bottom-right-radius: var(--border-radius-main);
  box-shadow: var(--current-glass-glow), 0 8px 35px rgba(0,0,0,0.12);
}
.message-content code { /* ... (same as previous) ... */ }
.copy-button { /* ... (same as previous good version) ... */ }
.message-timestamp { /* ... (same as previous good version) ... */ }

/* Streaming & Thinking Indicators */
.streaming-cursor { /* ... (same as previous gradient cursor) ... */ }
.aurora-loader { /* ... (same as previous) ... */ }
.ai-message.thinking-message span { /* ... (same as previous) ... */ }
.typing-indicator span { /* ... (same as previous) ... */ }

/* --- FOOTER / CHAT INPUT AREA --- */
.chat-input-area { /* Is .glassmorphic-element */
  padding: 18px clamp(15px, 3vw, 25px); 
  position: sticky; bottom: 0; z-index: 20; /* Higher z-index */

  background: var(--current-input-glass-bg); /* Specific glass for input area */
  backdrop-filter: blur(calc(var(--current-glass-blur-amount) + 6px)); 
  -webkit-backdrop-filter: blur(calc(var(--current-glass-blur-amount) + 6px));
  border-top: 1px solid var(--current-glass-border); 
  box-shadow: 0 -4px 15px rgba(0,0,0,0.07);

  border-bottom-left-radius: var(--border-radius-main); /* Match app-container rounding */
  border-bottom-right-radius: var(--border-radius-main);
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  transition: background var(--transition-speed-medium) ease, border var(--transition-speed-medium) ease, box-shadow var(--transition-speed-medium) ease;
}
.input-form { /* ... (same as previous good version) ... */ }
.chat-input { /* ... (same as previous good version) ... */ }
.chat-input::placeholder { /* ... (same as previous good version) ... */ }

.send-button { /* Is .neumorphic-element */
  width: 52px; height: 52px; /* ... (rest same as previous good version) ... */
}
/* Send button icon color fix for dark mode - MORE SPECIFIC */
body.dark-mode .send-button:not(:disabled) svg {
  fill: var(--dm-text-primary); /* Bright text color for icon */
}
body.dark-mode .send-button:hover:not(:disabled) svg {
  fill: var(--dm-primary-accent); /* Accent color on hover */
}

/* Scroll to Bottom Button */
.scroll-to-bottom-button { /* Is .neumorphic-element */
  position: fixed; /* Fixed position relative to viewport, within app container bounds */
  /* Dynamically calculate bottom based on footer height if possible, or fixed offset */
  bottom: calc(var(--footer-height, 90px) + clamp(15px, 2vw, 20px) + 15px); /* footer height + app padding + desired margin */
  right: clamp(25px, 4vw, 40px); /* Aligns with app padding + desired margin */
  width: 48px; height: 48px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; z-index: 30; /* Above chat area, header, footer */
  opacity: 0; transform: translateY(30px) scale(0.7);
  transition: opacity var(--transition-speed-medium) ease, transform var(--transition-speed-medium) cubic-bezier(0.34, 1.56, 0.64, 1); /* Bouncy */
  padding: 0;
}
.scroll-to-bottom-button.visible {
  opacity: 1;
  transform: translateY(0) scale(1);
}
.scroll-to-bottom-button svg { fill: var(--current-primary-accent); }

/* Initial Loading Spinner (already styled as glassmorphic) */
.initial-loading-container { /* ... same as previous ... */ }
.spinner { /* ... same as previous ... */ }

/* Responsive adjustments */
@media (max-width: 768px) {
  .app-container.cool-chat-theme {
    border-radius: 0; /* Edge to edge on mobile */
    max-height: 100vh;
    box-shadow: none; /* No main app shadow if edge-to-edge */
  }
  .app-header, .chat-input-area {
    border-left-radius: 0; 
    border-right-radius: 0; 
    /* Header still needs top radius if app container had one before going edge-to-edge */
    border-top-left-radius: 0; /* Was var(--border-radius-main); */
    border-top-right-radius: 0; /* Was var(--border-radius-main); */
    /* Footer still needs bottom radius */
    border-bottom-left-radius: 0; /* Was var(--border-radius-main); */
    border-bottom-right-radius: 0; /* Was var(--border-radius-main); */
  }
  .chat-area {
    /* Padding and margin logic for header/footer overlap remains the same, 
       --header-height and --footer-height variables handle it */
  }
  .scroll-to-bottom-button {
    bottom: calc(var(--footer-height, 70px) + 15px + 10px); /* footer + app-padding(from #root) + margin */
    right: 25px;
  }
}
@media (max-width: 600px) {
  /* ... (previous mobile adjustments for header controls, font sizes etc. are still good) ... */
}