/* src/index.css */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

:root {
  --font-family: 'Poppins', sans-serif;
  --transition-speed-fast: 0.25s;
  --transition-speed-medium: 0.4s;
  --transition-speed-slow: 0.6s;
  --border-radius-main: 28px; 
  --border-radius-medium: 20px;
  --border-radius-small: 16px;

  /* Light Mode Variables */
  --lm-bg-gradient: linear-gradient(145deg, #eef2f9 0%, #d8e0f0 100%); /* Adjusted for a cleaner light feel */
  --lm-text-primary: #1c2033; /* Slightly darker for better contrast */
  --lm-text-secondary: #505672;
  --lm-primary-accent: #5549e3; 
  --lm-secondary-accent: #776ef0;
  --lm-error-accent: #ff4d6d;

  --lm-neumorphic-shadow-light: rgba(255, 255, 255, 1);
  --lm-neumorphic-shadow-dark: rgba(155, 165, 185, 0.65);
  --lm-neumorphic-distance: 6px; 
  --lm-neumorphic-blur: 18px;

  /* Glass Variables - Light Mode */
  --lm-header-glass-bg-bottom: rgba(238, 242, 249, 0.3); /* Header bottom: more transparent */
  --lm-header-glass-bg-top: rgba(230, 235, 245, 0.7);   /* Header top: less transparent */
  --lm-chat-area-glass-bg: rgba(238, 242, 249, 0.45);  /* Chat Area: uniform glass */
  --lm-input-glass-bg: rgba(238, 242, 249, 0.55);    /* Input Area: uniform glass */
  --lm-ai-bubble-glass-bg: rgba(230, 235, 245, 0.75); /* AI Bubbles: slightly more opaque */
  
  --lm-glass-border: rgba(255, 255, 255, 0.8);
  --lm-glass-blur-amount: 10px; /* Standard blur for most glass */
  --lm-header-blur-amount: 7px; /* Header specific blur for text behind */
  --lm-glass-glow: 0 0 20px rgba(190, 190, 235, 0.25);
  --lm-bg-for-neumorph: #e6eaf4;


  /* Dark Mode Variables */
  --dm-bg-gradient: linear-gradient(145deg, #202331 0%, #11131a 100%);
  --dm-text-primary: #f2f4fd;
  --dm-text-secondary: #b0b6d3;
  --dm-primary-accent: #7a6bf0;
  --dm-secondary-accent: #9587f5;
  --dm-error-accent: #ff708f;

  --dm-neumorphic-shadow-light: rgba(85, 90, 115, 0.65);
  --dm-neumorphic-shadow-dark: rgba(0, 1, 5, 0.6);
  --dm-neumorphic-distance: 6px;
  --dm-neumorphic-blur: 18px;
  
  /* Glass Variables - Dark Mode */
  --dm-header-glass-bg-bottom: rgba(38, 41, 58, 0.4); /* Header bottom */
  --dm-header-glass-bg-top: rgba(45, 48, 70, 0.8);   /* Header top */
  --dm-chat-area-glass-bg: rgba(38, 41, 58, 0.55);  /* Chat Area */
  --dm-input-glass-bg: rgba(38, 41, 58, 0.65);    /* Input Area */
  --dm-ai-bubble-glass-bg: rgba(42, 45, 65, 0.8);   /* AI Bubbles */

  --dm-glass-border: rgba(100, 105, 130, 0.6);
  --dm-glass-blur-amount: 10px;
  --dm-header-blur-amount: 8px;
  --dm-glass-glow: 0 0 30px rgba(100, 90, 220, 0.4);
  --dm-bg-for-neumorph: #1f222c;
}

/* Apply current theme variables */
body {
  /* Default to Light Mode variables */
  background: var(--lm-bg-gradient);
  color: var(--lm-text-primary);
  --current-text-primary: var(--lm-text-primary);
  --current-text-secondary: var(--lm-text-secondary);
  --current-primary-accent: var(--lm-primary-accent);
  --current-secondary-accent: var(--lm-secondary-accent);
  --current-error-accent: var(--lm-error-accent);
  --current-neumorphic-shadow-light: var(--lm-neumorphic-shadow-light);
  --current-neumorphic-shadow-dark: var(--lm-neumorphic-shadow-dark);
  
  --current-header-glass-bg-bottom: var(--lm-header-glass-bg-bottom);
  --current-header-glass-bg-top: var(--lm-header-glass-bg-top);
  --current-chat-area-glass-bg: var(--lm-chat-area-glass-bg);
  --current-input-glass-bg: var(--lm-input-glass-bg);
  --current-ai-bubble-glass-bg: var(--lm-ai-bubble-glass-bg);

  --current-glass-border: var(--lm-glass-border);
  --current-glass-blur-amount: var(--lm-glass-blur-amount);
  --current-header-blur-amount: var(--lm-header-blur-amount);
  --current-glass-glow: var(--lm-glass-glow);
  --current-bg-for-neumorph: var(--lm-bg-for-neumorph);
}

body.dark-mode {
  background: var(--dm-bg-gradient);
  color: var(--dm-text-primary);
  /* Assign dark mode vars to current vars */
  --current-text-primary: var(--dm-text-primary);
  --current-text-secondary: var(--dm-text-secondary);
  --current-primary-accent: var(--dm-primary-accent);
  --current-secondary-accent: var(--dm-secondary-accent);
  --current-error-accent: var(--dm-error-accent);
  --current-neumorphic-shadow-light: var(--dm-neumorphic-shadow-light);
  --current-neumorphic-shadow-dark: var(--dm-neumorphic-shadow-dark);

  --current-header-glass-bg-bottom: var(--dm-header-glass-bg-bottom);
  --current-header-glass-bg-top: var(--dm-header-glass-bg-top);
  --current-chat-area-glass-bg: var(--dm-chat-area-glass-bg);
  --current-input-glass-bg: var(--dm-input-glass-bg);
  --current-ai-bubble-glass-bg: var(--dm-ai-bubble-glass-bg);
  
  --current-glass-border: var(--dm-glass-border);
  --current-glass-blur-amount: var(--dm-glass-blur-amount);
  --current-header-blur-amount: var(--dm-header-blur-amount);
  --current-glass-glow: var(--dm-glass-glow);
  --current-bg-for-neumorph: var(--dm-bg-for-neumorph);
}

/* General body and root setup */
body, html { /* ... same as previous ... */ }
#root { /* ... same as previous ... */ }

.app-container.cool-chat-theme {
  width: 100%; height: 100%;
  max-width: 880px; 
  max-height: 95vh;
  display: flex; flex-direction: column; overflow: hidden; position: relative;
  background: transparent; 
  border: none; 
  border-radius: var(--border-radius-main); 
  box-shadow: 0 20px 60px rgba(0,0,0,0.25); /* Overall subtle shadow for the app "window" */
  padding: 0; 
  box-sizing: border-box;
}

/* Neumorphic & Glassmorphic Bases */
.neumorphic-element { /* ... same as previous ... */ }
.glassmorphic-element { /* ... same as previous, using --current-input-glass-bg as a default */ }

/* Header - Gradient Glass & Sticky */
.app-header {
  padding: 18px clamp(15px, 3vw, 25px); 
  display: flex; justify-content: space-between; align-items: center;
  position: sticky; top: 0; z-index: 10;
  
  background: linear-gradient(to bottom, var(--current-header-glass-bg-top) 0%, var(--current-header-glass-bg-bottom) 100%);
  backdrop-filter: blur(var(--current-header-blur-amount));
  -webkit-backdrop-filter: blur(var(--current-header-blur-amount));
  border-bottom: 1px solid var(--current-glass-border);
  box-shadow: 0 5px 25px rgba(0,0,0,0.08);
  border-top-left-radius: var(--border-radius-main); /* Match app-container rounding */
  border-top-right-radius: var(--border-radius-main);
  border-bottom-left-radius: 0; /* Flat bottom edge that meets chat area */
  border-bottom-right-radius: 0;
  transition: background var(--transition-speed-medium) ease, border var(--transition-speed-medium) ease, box-shadow var(--transition-speed-medium) ease;
}
/* ... other header styles, model selector, theme toggle like before ... */
.header-title-area h1 { /* ... same ... */ }
.header-controls-area { /* ... same ... */ }
.model-selector-container { /* ... same, uses .glassmorphic-element which has its own bg now */
  background: var(--current-input-glass-bg); /* Override for consistency if needed */
} 
.neumorphic-select { /* ... same ... */ }
.model-selector-container::after { /* ... same ... */ }
.theme-toggle-button, .clear-chat-button { /* ... same ... */ }
body.dark-mode .clear-chat-button svg { fill: var(--dm-text-secondary); } /* Ensure clear icon is visible */
body.dark-mode .clear-chat-button:hover svg { fill: var(--dm-primary-accent); }


/* Chat Area - NEW: Glassmorphic, text scrolls behind header */
.chat-area {
  flex-grow: 1;
  overflow-y: auto;
  /* Padding top must be TALLER than header for text to scroll behind it BEFORE disappearing */
  /* CSS variable --header-height is set by JS in App.jsx */
  padding-top: calc(var(--header-height, 80px) + 15px); /* Header height + some buffer */
  margin-top: calc(-1 * var(--header-height, 80px)); /* Pull chat area up */
  
  padding-left: clamp(10px, 2vw, 20px);
  padding-right: clamp(10px, 2vw, 20px);
  padding-bottom: 20px;

  /* NEW Glassmorphism for chat-area itself */
  background: var(--current-chat-area-glass-bg);
  backdrop-filter: blur(var(--current-glass-blur-amount)); /* Can be different from header's blur */
  -webkit-backdrop-filter: blur(var(--current-glass-blur-amount));
  /* No border for chat area itself, it's a content well */
  
  display: flex; flex-direction: column;
  scrollbar-width: thin; scrollbar-color: var(--current-secondary-accent) transparent;
  position: relative;
  border-radius: 0; /* Chat area itself is a rectangle within the main rounded app */
  transition: background var(--transition-speed-medium) ease;
}
/* ... rest of .chat-area scrollbar styles ... */
.message-list { /* ... same as previous ... */ }
.message-wrapper { /* ... same ... */ }
.user-message { /* ... same ... */ }
.ai-message { /* Uses --current-ai-bubble-glass-bg now */
  background: var(--current-ai-bubble-glass-bg); 
  /* ... rest of ai-message styles like backdrop-filter, border, color ... */
  backdrop-filter: blur(var(--current-glass-blur-amount));
  -webkit-backdrop-filter: blur(var(--current-glass-blur-amount));
  border: 1.5px solid var(--current-glass-border);
  color: var(--current-text-primary);
  box-shadow: var(--current-glass-glow), 0 10px 45px rgba(0,0,0,0.15);
}
.copy-button { /* ... same ... */ }
.message-timestamp { /* ... same ... */ }

/* Streaming, Thinking, Pulsing Loaders */
.streaming-cursor { /* ... same styling as before ... */ }
.aurora-loader { /* ... same styling as before ... */ }
.ai-message.thinking-message span { /* ... same styling as before ... */ }
.typing-indicator span { /* ... same styling as before ... */ }


/* Chat Input Area - Glassmorphic */
.chat-input-area { /* Is .glassmorphic-element */
  padding: 18px clamp(15px, 3vw, 25px); 
  margin: 0; /* Footer spans full width of app-container */
  position: sticky; bottom: 0; z-index: 10;
  background: var(--current-input-glass-bg); /* Specific glass for input */
  backdrop-filter: blur(calc(var(--current-glass-blur-amount) + 4px)); /* Slightly more blur for input area */
  -webkit-backdrop-filter: blur(calc(var(--current-glass-blur-amount) + 4px));
  border-top: 1px solid var(--current-glass-border); /* Only top border */
  box-shadow: 0 -5px 25px rgba(0,0,0,0.08); /* Shadow upwards */
  border-bottom-left-radius: var(--border-radius-main); /* Match app-container rounding */
  border-bottom-right-radius: var(--border-radius-main);
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  transition: background var(--transition-speed-medium) ease, border var(--transition-speed-medium) ease, box-shadow var(--transition-speed-medium) ease;
}
/* ... rest of .input-form, .chat-input styling ... */
.chat-input::placeholder { color: var(--current-text-secondary); opacity: 0.7; }

.send-button { /* Is .neumorphic-element */
  /* ... same styling as before ... */
}
/* Send button icon color fix for dark mode */
body.dark-mode .send-button:not(:disabled) svg {
  fill: var(--dm-primary-accent); /* Use a brighter accent or primary text color */
}
body.dark-mode .send-button:hover:not(:disabled) svg {
  fill: var(--dm-secondary-accent); /* Or even brighter on hover */
}


/* Scroll to Bottom Button */
.scroll-to-bottom-button { /* Is .neumorphic-element */
  position: absolute;
  bottom: calc(var(--footer-height, 80px) + 20px); /* Position above the footer */
  right: clamp(15px, 3vw, 25px);
  /* ... rest of scroll-to-bottom styles from previous ... */
  z-index: 20; /* Above chat area, below header if it overlaps somehow */
}
.scroll-to-bottom-button.visible { /* ... same ... */ }
.scroll-to-bottom-button svg { fill: var(--current-primary-accent); }


/* Initial Loading Spinner */
.initial-loading-container { /* ... same as previous ... */ }
.spinner { /* ... same as previous ... */ }

/* Responsive Adjustments */
@media (max-width: 768px) {
  .app-container.cool-chat-theme {
    max-height: 100vh; 
    border-radius: 0; 
    padding: 0; /* Main container padding to 0 for mobile edge-to-edge */
  }
  .app-header, .chat-input-area {
    border-left-radius: 0; /* Edge to edge for header/footer bars on mobile */
    border-right-radius: 0; 
    /* Keep top/bottom radius to match app container IF app container still has radius on mobile */
    /* If app-container is truly edge-to-edge (no radius), then remove all radius from header/footer */
    border-top-left-radius: 0; 
    border-top-right-radius: 0;
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    margin-left: 0; margin-right: 0; /* Remove side margins if app-container has no padding */
  }
  .chat-area {
    /* Header height variable will adjust padding automatically */
  }
  .scroll-to-bottom-button {
    bottom: calc(var(--footer-height, 70px) + 15px); /* Adjust for mobile footer */
    right: 15px;
  }
}
@media (max-width: 600px) {
  .header-controls-area { 
    /* Consider stacking controls or reducing their size further if needed */
    gap: 8px;
  }
  .model-selector-container { max-width: 130px; } /* Further shrink */
  .neumorphic-select { font-size: 0.75rem; padding: 6px 20px 6px 8px; }
  .theme-toggle-button, .clear-chat-button { width: 38px; height: 38px; font-size: 1.1rem; }
  .clear-chat-button svg { width: 16px; height: 16px; }
  .send-button { width: 48px; height: 48px; }
  .scroll-to-bottom-button { width: 40px; height: 40px; }
  .message-list { padding: 0 5px; gap: 18px; }
  .message-bubble { padding: 12px 18px; font-size: 0.9rem; }
}